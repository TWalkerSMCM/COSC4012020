{% extends 'base.html' %}

{% block content %}
	<table id="table-view" class="table" style="width: 100%" />
{% endblock %}

{% block extra_js %}
	{% block javascript %}
	<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/bs4/jq-3.3.1/dt-1.10.22/datatables.min.css"/>
	<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/select/1.3.1/css/select.dataTables.min.css"/>
	
	
	<script type="text/javascript" src="https://cdn.datatables.net/v/bs4/jq-3.3.1/dt-1.10.22/datatables.min.js"></script>
	<script type="text/javascript" src="https://cdn.datatables.net/select/1.3.1/js/dataTables.select.min.js"></script>
	<script>
	$(document).ready(function() {
		var dt_table = $('#table-view').DataTable({
			select: {
            style: 'multi'
        	},
			<!-- could not get url reverse matching to work -->
			ajax: '/cdspec/spec_run_data',
			order: [[ 1, "desc" ]],
			columns: [
				{
					data: 'pk',
					visible: false
				},
				{
					title: 'Creation User',
					data: 'run_user'
				},
				{
					title: 'Date',
					data: 'upload_date',
					render: function (data) {
						let date = new Date(data);
						return date.getFullYear() + '-' + (date.getMonth() + 1) + '-' + date.getDate();
					}
				},
				{
					title: 'Upload User waiting dbchange',
					data: 'run_user'
				},
				{
					title: 'Spectrometer',
					data: 'protein_concentration'
				},
				{
					title: 'Molecule Name',
					data: 'run_title',
					render: function (data, type, row) {
						return '<a href="/cdspec/' + row.pk + '">' + row.run_title + '</a>';
					}					
				},
			],
			searching: true,
			processing: true,
			serverSide: true
		});
	});
	</script>
	{% endblock javascript %}

{% endblock extra_js %}